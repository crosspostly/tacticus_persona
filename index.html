<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WH40K Tacticus - –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ú–∞—Ç—á–µ–π</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e, #0f0f1e);
            color: #e4e4e4;
            min-height: 100vh;
        }
        .container { 
            max-width: 1400px; 
            margin: 0 auto; 
            padding: 20px;
        }
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #00d4ff;
            font-size: 2.5em;
            text-shadow: 0 0 20px rgba(0, 212, 255, 0.5);
            background: linear-gradient(45deg, #00d4ff, #00ff88);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        .status-bar {
            background: #16213e;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            border: 2px solid #00d4ff;
            text-align: center;
            font-weight: bold;
        }
        .status-bar.success {
            border-color: #00ff88;
            color: #00ff88;
            background: #0a1a0a;
        }
        .main-grid {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .control-panel {
            background: #16213e;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00d4ff;
            max-height: 80vh;
            overflow-y: auto;
        }
        .control-section {
            margin-bottom: 25px;
        }
        .control-section h3 {
            color: #00d4ff;
            margin-bottom: 10px;
            font-size: 1.1em;
            border-bottom: 2px solid #0f1a2e;
            padding-bottom: 5px;
        }
        select, button {
            width: 100%;
            padding: 10px;
            background: #0f1a2e;
            color: #e4e4e4;
            border: 2px solid #00d4ff;
            border-radius: 5px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 10px;
        }
        button {
            background: #00d4ff;
            color: #1a1a2e;
            font-weight: bold;
        }
        button:hover {
            background: #00ff88;
            transform: scale(1.02);
            box-shadow: 0 4px 15px rgba(0, 255, 136, 0.3);
        }
        .display-area {
            background: #16213e;
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #00d4ff;
            min-height: 500px;
        }
        .character-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        .char-card {
            background: #0f1a2e;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #00d4ff;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }
        .char-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 212, 255, 0.3);
            border-color: #00ff88;
        }
        .char-card.selected {
            border-color: #00ff88;
            background: #0a1a0a;
        }
        .char-name {
            font-weight: bold;
            color: #00d4ff;
            margin-bottom: 10px;
            font-size: 1.1em;
        }
        .char-faction {
            color: #888;
            font-size: 0.9em;
            margin-bottom: 8px;
        }
        .char-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            font-size: 0.85em;
        }
        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 2px 0;
        }
        .stat-label { color: #888; }
        .stat-value { color: #fff; font-weight: bold; }
        .char-traits {
            margin-top: 8px;
            font-size: 0.8em;
            color: #00ff88;
            font-style: italic;
        }
        .battle-area {
            display: none;
            padding: 20px;
            background: #0f1a2e;
            border-radius: 8px;
            margin-top: 15px;
        }
        .battle-area.active {
            display: block;
        }
        .battle-header {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 20px;
            align-items: center;
            margin-bottom: 20px;
            text-align: center;
        }
        .vs-divider {
            font-size: 2em;
            color: #ff6b6b;
            font-weight: bold;
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        .battle-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        .battle-card {
            background: #16213e;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #00d4ff;
        }
        .battle-card.attacker {
            border-color: #00ff88;
        }
        .battle-card.defender {
            border-color: #ff6b6b;
        }
        .result-area {
            background: linear-gradient(135deg, #16213e, #0f1a2e);
            padding: 20px;
            border-radius: 8px;
            border: 2px solid #00d4ff;
            text-align: center;
        }
        .win-probability {
            font-size: 3em;
            font-weight: bold;
            margin: 10px 0;
            text-shadow: 0 0 10px currentColor;
        }
        .win-probability.high { color: #00ff88; }
        .win-probability.medium { color: #fbbf24; }
        .win-probability.low { color: #ff6b6b; }
        .analysis-text {
            margin-top: 15px;
            padding: 15px;
            background: #0f1a2e;
            border-radius: 8px;
            border-left: 4px solid #00d4ff;
            text-align: left;
            font-size: 0.95em;
            line-height: 1.5;
        }
        .synergy-section {
            margin-top: 20px;
            padding: 15px;
            background: #0a1a0a;
            border-radius: 8px;
            border: 2px solid #00ff88;
        }
        .synergy-list {
            list-style: none;
            padding: 0;
            margin-top: 10px;
        }
        .synergy-item {
            background: #16213e;
            padding: 10px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 3px solid #00ff88;
            font-size: 0.9em;
        }
        .loading {
            text-align: center;
            padding: 40px;
            font-size: 1.2em;
            color: #00d4ff;
        }
        .error {
            color: #ff6b6b;
            background: #2a0a0a;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #ff6b6b;
            margin: 10px 0;
        }
        @media (max-width: 768px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
            .control-panel {
                max-height: none;
            }
            .battle-header {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            .vs-divider {
                transform: rotate(90deg);
                margin: 10px 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚öîÔ∏è WH40K Tacticus - –ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –ú–∞—Ç—á–µ–π</h1>
        
        <div id="statusBar" class="status-bar">
            üîÑ –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö...
        </div>
        
        <div class="main-grid">
            <div class="control-panel">
                <div class="control-section">
                    <h3>üó°Ô∏è –ê–¢–ê–ö–£–Æ–©–ò–ô</h3>
                    <select id="attackerSelect">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</option>
                    </select>
                </div>
                
                <div class="control-section">
                    <h3>üõ°Ô∏è –ó–ê–©–ò–©–ê–Æ–©–ò–ô–°–Ø</h3>
                    <select id="defenderSelect">
                        <option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</option>
                    </select>
                </div>
                
                <div class="control-section">
                    <h3>‚ö°Ô∏è –î–ï–ô–°–¢–í–ò–Ø</h3>
                    <button onclick="analyzeBattle()">üîç –ê–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –±–æ–π</button>
                    <button onclick="loadRandomMatchup()">üé≤ –°–ª—É—á–∞–π–Ω—ã–π –º–∞—Ç—á</button>
                    <button onclick="resetSelection()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å –≤—ã–±–æ—Ä</button>
                </div>
                
                <div class="control-section">
                    <h3>üìä –§–ò–õ–¨–¢–†–´</h3>
                    <select id="factionFilter" onchange="filterCharacters()">
                        <option value="">–í—Å–µ —Ñ—Ä–∞–∫—Ü–∏–∏</option>
                    </select>
                    <select id="rarityFilter" onchange="filterCharacters()">
                        <option value="">–í—Å–µ —Ä–µ–¥–∫–æ—Å—Ç–∏</option>
                    </select>
                </div>
            </div>
            
            <div class="display-area">
                <div id="characterDisplay" class="character-list">
                    <div class="loading">–ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π...</div>
                </div>
                
                <div id="battleArea" class="battle-area">
                    <div class="battle-header">
                        <div id="attackerCard" class="battle-card attacker"></div>
                        <div class="vs-divider">VS</div>
                        <div id="defenderCard" class="battle-card defender"></div>
                    </div>
                    
                    <div class="result-area">
                        <h3>üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç –∞–Ω–∞–ª–∏–∑–∞</h3>
                        <div id="winProbability" class="win-probability">--%</div>
                        <div id="analysisResult" class="analysis-text"></div>
                        
                        <div id="synergySection" class="synergy-section">
                            <h3>ü§ù –°–∏–Ω–µ—Ä–≥–∏—è –∏ –∫–æ–Ω—Ç—Ä—ã</h3>
                            <ul id="synergyList" class="synergy-list"></ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let characters = [];
        let matchups = [];
        let synergies = [];
        let selectedAttacker = null;
        let selectedDefender = null;

        // –§—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
        async function loadTextFile(filename) {
            try {
                const response = await fetch(filename);
                if (!response.ok) {
                    throw new Error(`–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ ${filename}: ${response.status}`);
                }
                const text = await response.text();
                return text.trim().split('\n').filter(line => line.trim());
            } catch (error) {
                console.error(`–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ${filename}:`, error);
                throw error;
            }
        }

        // –ü–∞—Ä—Å–∏–Ω–≥ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
        function parseCharacters(lines) {
            characters = [];
            lines.forEach((line, index) => {
                const parts = line.split('|');
                if (parts.length >= 9) {
                    characters.push({
                        name: parts[0].trim(),
                        hp: parseInt(parts[1]) || 0,
                        armor: parseInt(parts[2]) || 0,
                        damage: parseInt(parts[3]) || 0,
                        melee: parts[4].trim(),
                        ranged: parts[5].trim(),
                        traits: parts[6].trim(),
                        rarity: parts[7].trim(),
                        faction: parts[8].trim(),
                        id: index + 1
                    });
                }
            });
            console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π: ${characters.length}`);
            return characters;
        }

        // –ü–∞—Ä—Å–∏–Ω–≥ –º–∞—Ç—á–µ–π –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
        function parseMatchups(lines) {
            matchups = [];
            lines.forEach(line => {
                const parts = line.split(';');
                if (parts.length >= 4) {
                    matchups.push({
                        attacker: parts[0].trim(),
                        defender: parts[1].trim(),
                        winRate: parseInt(parts[2]) || 50,
                        description: parts[3].trim()
                    });
                }
            });
            console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ –º–∞—Ç—á–µ–π: ${matchups.length}`);
            return matchups;
        }

        // –ü–∞—Ä—Å–∏–Ω–≥ —Å–∏–Ω–µ—Ä–≥–∏–∏ –∏–∑ —Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞
        function parseSynergies(lines) {
            synergies = [];
            lines.forEach(line => {
                const parts = line.split(';');
                if (parts.length >= 4) {
                    synergies.push({
                        char1: parts[0].trim(),
                        char2: parts[1].trim(),
                        synergy: parseInt(parts[2]) || 50,
                        description: parts[3].trim()
                    });
                }
            });
            console.log(`–ó–∞–≥—Ä—É–∂–µ–Ω–æ —Å–∏–Ω–µ—Ä–≥–∏–π: ${synergies.length}`);
            return synergies;
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
        async function loadAllData() {
            try {
                const statusBar = document.getElementById('statusBar');
                statusBar.textContent = 'üìÅ –ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π...';
                
                const characterLines = await loadTextFile('characters.txt');
                parseCharacters(characterLines);
                
                statusBar.textContent = '‚öîÔ∏è –ó–∞–≥—Ä—É–∑–∫–∞ –º–∞—Ç—á–µ–π...';
                const matchupLines = await loadTextFile('matchups.txt');
                parseMatchups(matchupLines);
                
                statusBar.textContent = 'ü§ù –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∏–Ω–µ—Ä–≥–∏–∏...';
                const synergyLines = await loadTextFile('synergy.txt');
                parseSynergies(synergyLines);
                
                statusBar.textContent = '‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!';
                statusBar.classList.add('success');
                
                initializeUI();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:', error);
                const statusBar = document.getElementById('statusBar');
                statusBar.innerHTML = `<div class="error">‚ùå –û—à–∏–±–∫–∞: ${error.message}</div>`;
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
                loadEmbeddedData();
            }
        }

        // –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–ª—É—á–∞–π –æ—à–∏–±–∫–∏
        function loadEmbeddedData() {
            const statusBar = document.getElementById('statusBar');
            statusBar.textContent = 'üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö...';
            
            characters = [
                {id: 1, name: "Abaddon The Despoiler", hp: 100, armor: 25, damage: 15, melee: "Power / 5 hits", ranged: "Bolter / 3 hits / Range 2", traits: "Let the Galaxy Burn, Resilient", rarity: "Legendary", faction: "Chaos"},
                {id: 2, name: "Dante", hp: 95, armor: 24, damage: 16, melee: "Axe Mortalis / 4 hits", ranged: "Bolter / 3 hits / Range 2", traits: "Blood Angels, Chapter Master", rarity: "Epic", faction: "Imperium"},
                {id: 3, name: "Ghazghkull Thraka", hp: 110, armor: 28, damage: 14, melee: "Power Klaw / 3 hits", ranged: "Shoota / 3 hits / Range 2", traits: "Orks, Warboss, WAAAGH!", rarity: "Epic", faction: "Orks"},
                {id: 4, name: "Eldrad Ulthran", hp: 60, armor: 12, damage: 25, melee: "Witch Staff / 3 hits", ranged: "Psychic / 2 hits / Range 4", traits: "Farseer, Psychic, Eldar", rarity: "Epic", faction: "Eldar"},
                {id: 5, name: "Roboute Guilliman", hp: 120, armor: 30, damage: 20, melee: "Hand of Dominion / 5 hits", ranged: "Bolter / 4 hits / Range 3", traits: "Ultramarines, Primarch", rarity: "Legendary", faction: "Imperium"}
            ];
            
            matchups = [
                {attacker: "Abaddon The Despoiler", defender: "Dante", winRate: 85, description: "Abaddon's superior damage and traits give him advantage"},
                {attacker: "Dante", defender: "Ghazghkull Thraka", winRate: 70, description: "Dante's speed vs Ghazghkull's toughness"},
                {attacker: "Ghazghkull Thraka", defender: "Eldrad Ulthran", winRate: 60, description: "Ork durability vs psychic power"},
                {attacker: "Eldrad Ulthran", defender: "Roboute Guilliman", winRate: 40, description: "Primarch's overwhelming stats"}
            ];
            
            synergies = [
                {char1: "Abaddon The Despoiler", char2: "Dante", synergy: 75, description: "Chaos vs Imperial rivalry"},
                {char1: "Dante", char2: "Ghazghkull Thraka", synergy: 60, description: "Cross-faction battle"},
                {char1: "Ghazghkull Thraka", char2: "Eldrad Ulthran", synergy: 50, description: "Ork vs Eldar ancient conflict"}
            ];
            
            statusBar.textContent = '‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã!';
            statusBar.classList.add('success');
            
            initializeUI();
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        function initializeUI() {
            populateSelects();
            populateFilters();
            displayCharacters();
        }

        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–µ–ª–µ–∫—Ç–æ–≤ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞–º–∏
        function populateSelects() {
            const attackerSelect = document.getElementById('attackerSelect');
            const defenderSelect = document.getElementById('defenderSelect');
            
            attackerSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</option>';
            defenderSelect.innerHTML = '<option value="">–í—ã–±–µ—Ä–∏—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞</option>';
            
            characters.forEach(char => {
                const option1 = new Option(`${char.name} (${char.faction})`, char.id);
                const option2 = new Option(`${char.name} (${char.faction})`, char.id);
                attackerSelect.add(option1);
                defenderSelect.add(option2);
            });
            
            attackerSelect.addEventListener('change', (e) => {
                selectedAttacker = characters.find(c => c.id == e.target.value);
                if (selectedAttacker && selectedDefender) {
                    analyzeBattle();
                }
            });
            
            defenderSelect.addEventListener('change', (e) => {
                selectedDefender = characters.find(c => c.id == e.target.value);
                if (selectedAttacker && selectedDefender) {
                    analyzeBattle();
                }
            });
        }

        // –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
        function populateFilters() {
            const factionFilter = document.getElementById('factionFilter');
            const rarityFilter = document.getElementById('rarityFilter');
            
            // –§—Ä–∞–∫—Ü–∏–∏
            const factions = [...new Set(characters.map(c => c.faction))];
            factionFilter.innerHTML = '<option value="">–í—Å–µ —Ñ—Ä–∞–∫—Ü–∏–∏</option>';
            factions.forEach(faction => {
                factionFilter.add(new Option(faction, faction));
            });
            
            // –†–µ–¥–∫–æ—Å—Ç—å
            const rarities = [...new Set(characters.map(c => c.rarity))];
            rarityFilter.innerHTML = '<option value="">–í—Å–µ —Ä–µ–¥–∫–æ—Å—Ç–∏</option>';
            rarities.forEach(rarity => {
                rarityFilter.add(new Option(rarity, rarity));
            });
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
        function displayCharacters() {
            const display = document.getElementById('characterDisplay');
            
            const factionFilter = document.getElementById('factionFilter').value;
            const rarityFilter = document.getElementById('rarityFilter').value;
            
            let filteredChars = characters;
            
            if (factionFilter) {
                filteredChars = filteredChars.filter(c => c.faction === factionFilter);
            }
            
            if (rarityFilter) {
                filteredChars = filteredChars.filter(c => c.rarity === rarityFilter);
            }
            
            display.innerHTML = '';
            
            if (filteredChars.length === 0) {
                display.innerHTML = '<div class="loading">–ü–µ—Ä—Å–æ–Ω–∞–∂–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
                return;
            }
            
            filteredChars.forEach(char => {
                const card = createCharacterCard(char);
                display.appendChild(card);
            });
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        function createCharacterCard(char) {
            const card = document.createElement('div');
            card.className = 'char-card';
            card.onclick = () => selectCharacter(char);
            
            card.innerHTML = `
                <div class="char-name">${char.name}</div>
                <div class="char-faction">${char.faction} ‚Ä¢ ${char.rarity}</div>
                <div class="char-stats">
                    <div class="stat-row">
                        <span class="stat-label">‚ù§Ô∏è HP:</span>
                        <span class="stat-value">${char.hp}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">üõ°Ô∏è –ë—Ä–æ–Ω—è:</span>
                        <span class="stat-value">${char.armor}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">‚öîÔ∏è –£—Ä–æ–Ω:</span>
                        <span class="stat-value">${char.damage}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">üó°Ô∏è –ë–ª–∏–∂–Ω–∏–π:</span>
                        <span class="stat-value">${char.melee}</span>
                    </div>
                    <div class="stat-row">
                        <span class="stat-label">üèπ –î–∞–ª—å–Ω–∏–π:</span>
                        <span class="stat-value">${char.ranged}</span>
                    </div>
                </div>
                <div class="char-traits">${char.traits}</div>
            `;
            
            return card;
        }

        // –í—ã–±–æ—Ä –ø–µ—Ä—Å–æ–Ω–∞–∂–∞
        function selectCharacter(char) {
            if (!selectedAttacker) {
                selectedAttacker = char;
                document.getElementById('attackerSelect').value = char.id;
            } else if (!selectedDefender && char.id !== selectedAttacker.id) {
                selectedDefender = char;
                document.getElementById('defenderSelect').value = char.id;
                analyzeBattle();
            } else {
                resetSelection();
                selectedAttacker = char;
                document.getElementById('attackerSelect').value = char.id;
            }
            
            updateCharacterCards();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—ã–¥–µ–ª–µ–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫
        function updateCharacterCards() {
            const cards = document.querySelectorAll('.char-card');
            cards.forEach(card => {
                card.classList.remove('selected');
            });
        }

        // –ê–Ω–∞–ª–∏–∑ –±–æ—è
        function analyzeBattle() {
            if (!selectedAttacker || !selectedDefender) {
                return;
            }
            
            const battleArea = document.getElementById('battleArea');
            battleArea.classList.add('active');
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –±–æ–π—Ü–æ–≤
            document.getElementById('attackerCard').innerHTML = createBattleCard(selectedAttacker, '–ê—Ç–∞–∫—É—é—â–∏–π');
            document.getElementById('defenderCard').innerHTML = createBattleCard(selectedDefender, '–ó–∞—â–∏—â–∞—é—â–∏–π—Å—è');
            
            // –†–∞—Å—á–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ–±–µ–¥—ã
            const winRate = calculateWinRate(selectedAttacker, selectedDefender);
            
            // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
            displayResults(winRate);
        }

        // –°–æ–∑–¥–∞–Ω–∏–µ –±–æ–µ–≤–æ–π –∫–∞—Ä—Ç–æ—á–∫–∏
        function createBattleCard(char, role) {
            return `
                <h4 style="color: #00d4ff; margin-bottom: 10px;">${role}</h4>
                <div style="font-weight: bold; font-size: 1.1em; margin-bottom: 8px;">${char.name}</div>
                <div style="font-size: 0.9em; color: #888; margin-bottom: 10px;">${char.faction}</div>
                <div style="font-size: 0.85em;">
                    <div>‚ù§Ô∏è HP: ${char.hp}</div>
                    <div>üõ°Ô∏è –ë—Ä–æ–Ω—è: ${char.armor}</div>
                    <div>‚öîÔ∏è –£—Ä–æ–Ω: ${char.damage}</div>
                    <div>üó°Ô∏è ${char.melee}</div>
                    <div>üèπ ${char.ranged}</div>
                </div>
            `;
        }

        // –†–∞—Å—á–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –ø–æ–±–µ–¥—ã
        function calculateWinRate(attacker, defender) {
            // –ü–æ–∏—Å–∫ –≤ –±–∞–∑–µ –º–∞—Ç—á–µ–π
            const matchup = matchups.find(m => 
                m.attacker === attacker.name && m.defender === defender.name
            );
            
            if (matchup) {
                return matchup.winRate;
            }
            
            // –ï—Å–ª–∏ –Ω–µ—Ç –≤ –±–∞–∑–µ, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
            const attackScore = (attacker.damage + attacker.hp/10 + attacker.armor/5) * 10;
            const defenseScore = (defender.damage + defender.hp/10 + defender.armor/5) * 10;
            
            let winRate = 50 + (attackScore - defenseScore) / 2;
            winRate = Math.max(10, Math.min(90, winRate));
            
            return Math.round(winRate);
        }

        // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
        function displayResults(winRate) {
            const winProb = document.getElementById('winProbability');
            const analysis = document.getElementById('analysisResult');
            const synergyList = document.getElementById('synergyList');
            
            winProb.textContent = winRate + '%';
            winProb.className = 'win-probability';
            
            if (winRate >= 70) {
                winProb.classList.add('high');
                analysis.innerHTML = `<strong>üí™ –û—Ç–ª–∏—á–Ω—ã–π –º–∞—Ç—á!</strong><br>${selectedAttacker.name} –∏–º–µ–µ—Ç –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ –Ω–∞–¥ ${selectedDefender.name}. –†–µ–∫–æ–º–µ–Ω–¥—É—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç–æ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞ –≤ –±–æ—é.`;
            } else if (winRate >= 55) {
                winProb.classList.add('medium');
                analysis.innerHTML = `<strong>‚öñÔ∏è –•–æ—Ä–æ—à–∏–π –º–∞—Ç—á</strong><br>${selectedAttacker.name} –∏–º–µ–µ—Ç —É–º–µ—Ä–µ–Ω–Ω–æ–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ. –ë–æ–π –±—É–¥–µ—Ç –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–º, –Ω–æ —à–∞–Ω—Å—ã –Ω–∞ –ø–æ–±–µ–¥—É –≤—ã—à–µ.`;
            } else {
                winProb.classList.add('low');
                analysis.innerHTML = `<strong>‚ö†Ô∏è –°–ª–æ–∂–Ω—ã–π –º–∞—Ç—á</strong><br>${selectedAttacker.name} –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –Ω–µ–≤—ã–≥–æ–¥–Ω–æ–º –ø–æ–ª–æ–∂–µ–Ω–∏–∏ –ø—Ä–æ—Ç–∏–≤ ${selectedDefender.name}. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ —Å–º–µ–Ω—É —Ç–∞–∫—Ç–∏–∫–∏.`;
            }
            
            // –°–∏–Ω–µ—Ä–≥–∏—è –∏ –∫–æ–Ω—Ç—Ä—ã
            const synergy = synergies.find(s => 
                (s.char1 === selectedAttacker.name && s.char2 === selectedDefender.name) ||
                (s.char2 === selectedAttacker.name && s.char1 === selectedDefender.name)
            );
            
            synergyList.innerHTML = '';
            
            if (synergy) {
                const item = document.createElement('li');
                item.className = 'synergy-item';
                item.innerHTML = `<strong>ü§ù –°–∏–Ω–µ—Ä–≥–∏—è:</strong> ${synergy.description} (${synergy.synergy}%)`;
                synergyList.appendChild(item);
            }
            
            // –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç—Ä–æ–≤
            const counters = synergies.filter(s => s.char1 === selectedDefender.name);
            counters.slice(0, 3).forEach(counter => {
                const item = document.createElement('li');
                item.className = 'synergy-item';
                item.innerHTML = `<strong>‚ö†Ô∏è –ö–æ–Ω—Ç—Ä –¥–ª—è ${selectedDefender.name}:</strong> ${counter.char2} - ${counter.description}`;
                synergyList.appendChild(item);
            });
        }

        // –°–ª—É—á–∞–π–Ω—ã–π –º–∞—Ç—á
        function loadRandomMatchup() {
            if (characters.length < 2) return;
            
            const randomAttacker = characters[Math.floor(Math.random() * characters.length)];
            let randomDefender = characters[Math.floor(Math.random() * characters.length)];
            
            while (randomDefender.id === randomAttacker.id) {
                randomDefender = characters[Math.floor(Math.random() * characters.length)];
            }
            
            selectedAttacker = randomAttacker;
            selectedDefender = randomDefender;
            
            document.getElementById('attackerSelect').value = randomAttacker.id;
            document.getElementById('defenderSelect').value = randomDefender.id;
            
            analyzeBattle();
        }

        // –°–±—Ä–æ—Å –≤—ã–±–æ—Ä–∞
        function resetSelection() {
            selectedAttacker = null;
            selectedDefender = null;
            
            document.getElementById('attackerSelect').value = '';
            document.getElementById('defenderSelect').value = '';
            document.getElementById('battleArea').classList.remove('active');
            
            updateCharacterCards();
        }

        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π
        function filterCharacters() {
            displayCharacters();
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', () => {
            loadAllData();
        });
    </script>
</body>
</html>